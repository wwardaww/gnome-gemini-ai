<html>

<head>
    <script src="
    https://cdn.jsdelivr.net/npm/markdown-it@14.1.0/dist/markdown-it.min.js
    "></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        let translator;
        var translate = (key) => {
            if (typeof translator === "object" && Object.keys(translator).includes(key)) {
                return translator[key];
            } else {
                return key;
            }

        }
    </script>
</head>

<body class='default'>
    <div class="wrapper home">
        <div class="actions">
            <input type="text" id="chat">
            <div class="btns">
                <button id="delete" class="btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                        viewBox="0 0 24 24" fill="none">
                        <path
                            d="M7.64826 10.125C7.64826 10.344 7.56128 10.554 7.40645 10.7088C7.25162 10.8636 7.04163 10.9506 6.82267 10.9506C6.60372 10.9506 6.39373 10.8636 6.2389 10.7088C6.08407 10.554 5.99709 10.344 5.99709 10.125C5.99709 9.90605 6.08407 9.69606 6.2389 9.54123C6.39373 9.3864 6.60372 9.29942 6.82267 9.29942C7.04163 9.29942 7.25162 9.3864 7.40645 9.54123C7.56128 9.69606 7.64826 9.90605 7.64826 10.125ZM10.9506 10.125C10.9506 10.344 10.8636 10.554 10.7088 10.7088C10.5539 10.8636 10.344 10.9506 10.125 10.9506C9.90604 10.9506 9.69605 10.8636 9.54123 10.7088C9.3864 10.554 9.29942 10.344 9.29942 10.125C9.29942 9.90605 9.3864 9.69606 9.54123 9.54123C9.69605 9.3864 9.90604 9.29942 10.125 9.29942C10.344 9.29942 10.5539 9.3864 10.7088 9.54123C10.8636 9.69606 10.9506 9.90605 10.9506 10.125ZM14.2529 10.125C14.2529 10.344 14.1659 10.554 14.0111 10.7088C13.8563 10.8636 13.6463 10.9506 13.4273 10.9506C13.2084 10.9506 12.9984 10.8636 12.8436 10.7088C12.6887 10.554 12.6017 10.344 12.6017 10.125C12.6017 9.90605 12.6887 9.69606 12.8436 9.54123C12.9984 9.3864 13.2084 9.29942 13.4273 9.29942C13.6463 9.29942 13.8563 9.3864 14.0111 9.54123C14.1659 9.69606 14.2529 9.90605 14.2529 10.125Z"
                            fill="#8E8E93" />
                        <path
                            d="M10.125 1.25C15.0265 1.25 19 5.22352 19 10.125H17.7616C17.7616 8.09964 16.9571 6.15723 15.5249 4.72509C14.0928 3.29294 12.1504 2.48837 10.125 2.48837C8.09964 2.48837 6.15723 3.29294 4.72509 4.72509C3.29294 6.15723 2.48837 8.09964 2.48837 10.125C2.4863 11.3047 2.75907 12.4687 3.28506 13.5247C3.50368 13.9517 3.55859 14.4438 3.43944 14.9084L2.9474 16.7462C2.92674 16.8231 2.92669 16.9042 2.94727 16.9811C2.96785 17.0581 3.00832 17.1283 3.06462 17.1847C3.12093 17.2411 3.19108 17.2817 3.26803 17.3024C3.34498 17.3231 3.42602 17.3232 3.50301 17.3026L5.34158 16.8106C5.80619 16.6914 6.29833 16.7463 6.72526 16.9649C7.78125 17.4909 8.94526 17.7637 10.125 17.7616V19C8.75354 19.0019 7.40046 18.6845 6.17294 18.0729C6.01569 17.9904 5.83411 17.967 5.66108 18.0068L3.82334 18.4989C2.56515 18.8357 1.41429 17.6848 1.75113 16.4267L2.24235 14.5889C2.28363 14.4362 2.26464 14.2546 2.1763 14.0771C1.58353 12.8866 1.25 11.5434 1.25 10.125C1.25 5.22352 5.22352 1.25 10.125 1.25Z"
                            fill="#8E8E93" />
                        <path
                            d="M22.5417 12.9167H20.25V12.4583C20.25 12.0937 20.1051 11.7439 19.8473 11.4861C19.5894 11.2282 19.2397 11.0833 18.875 11.0833H16.125C15.7603 11.0833 15.4106 11.2282 15.1527 11.4861C14.8949 11.7439 14.75 12.0937 14.75 12.4583V12.9167H12.4583C12.3368 12.9167 12.2202 12.965 12.1342 13.0509C12.0483 13.1369 12 13.2535 12 13.375C12 13.4966 12.0483 13.6131 12.1342 13.6991C12.2202 13.7851 12.3368 13.8333 12.4583 13.8333H12.9167V22.0833C12.9167 22.3265 13.0132 22.5596 13.1852 22.7315C13.3571 22.9034 13.5902 23 13.8333 23H21.1667C21.4098 23 21.6429 22.9034 21.8148 22.7315C21.9868 22.5596 22.0833 22.3265 22.0833 22.0833V13.8333H22.5417C22.6632 13.8333 22.7798 13.7851 22.8658 13.6991C22.9517 13.6131 23 13.4966 23 13.375C23 13.2535 22.9517 13.1369 22.8658 13.0509C22.7798 12.965 22.6632 12.9167 22.5417 12.9167ZM15.6667 12.4583C15.6667 12.3368 15.715 12.2202 15.8009 12.1343C15.8869 12.0483 16.0034 12 16.125 12H18.875C18.9966 12 19.1131 12.0483 19.1991 12.1343C19.285 12.2202 19.3333 12.3368 19.3333 12.4583V12.9167H15.6667V12.4583ZM21.1667 22.0833H13.8333V13.8333H21.1667V22.0833ZM16.5833 16.125V19.7917C16.5833 19.9132 16.535 20.0298 16.4491 20.1158C16.3631 20.2017 16.2466 20.25 16.125 20.25C16.0034 20.25 15.8869 20.2017 15.8009 20.1158C15.715 20.0298 15.6667 19.9132 15.6667 19.7917V16.125C15.6667 16.0035 15.715 15.8869 15.8009 15.8009C15.8869 15.715 16.0034 15.6667 16.125 15.6667C16.2466 15.6667 16.3631 15.715 16.4491 15.8009C16.535 15.8869 16.5833 16.0035 16.5833 16.125ZM19.3333 16.125V19.7917C19.3333 19.9132 19.285 20.0298 19.1991 20.1158C19.1131 20.2017 18.9966 20.25 18.875 20.25C18.7534 20.25 18.6369 20.2017 18.5509 20.1158C18.465 20.0298 18.4167 19.9132 18.4167 19.7917V16.125C18.4167 16.0035 18.465 15.8869 18.5509 15.8009C18.6369 15.715 18.7534 15.6667 18.875 15.6667C18.9966 15.6667 19.1131 15.715 19.1991 15.8009C19.285 15.8869 19.3333 16.0035 19.3333 16.125Z"
                            fill="#8E8E93" />
                    </svg></button>
                <button id="settings" class="btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                        viewBox="0 0 24 24" fill="none">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M12 8.25C11.0054 8.25 10.0516 8.64509 9.34835 9.34835C8.64509 10.0516 8.25 11.0054 8.25 12C8.25 12.9946 8.64509 13.9484 9.34835 14.6517C10.0516 15.3549 11.0054 15.75 12 15.75C12.9946 15.75 13.9484 15.3549 14.6517 14.6517C15.3549 13.9484 15.75 12.9946 15.75 12C15.75 11.0054 15.3549 10.0516 14.6517 9.34835C13.9484 8.64509 12.9946 8.25 12 8.25ZM9.75 12C9.75 11.4033 9.98705 10.831 10.409 10.409C10.831 9.98705 11.4033 9.75 12 9.75C12.5967 9.75 13.169 9.98705 13.591 10.409C14.0129 10.831 14.25 11.4033 14.25 12C14.25 12.5967 14.0129 13.169 13.591 13.591C13.169 14.0129 12.5967 14.25 12 14.25C11.4033 14.25 10.831 14.0129 10.409 13.591C9.98705 13.169 9.75 12.5967 9.75 12Z"
                            fill="#8E8E93" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M11.975 1.25C11.53 1.25 11.159 1.25 10.855 1.27C10.5442 1.28252 10.2377 1.34673 9.948 1.46C9.61425 1.59809 9.31098 1.80057 9.05549 2.05589C8.8 2.3112 8.59732 2.61434 8.459 2.948C8.314 3.298 8.275 3.668 8.259 4.07C8.25722 4.21698 8.21822 4.36112 8.14565 4.48895C8.07308 4.61678 7.9693 4.72414 7.844 4.801C7.71483 4.87132 7.56993 4.90775 7.42286 4.90687C7.27579 4.906 7.13133 4.86785 7.003 4.796C6.647 4.608 6.307 4.457 5.931 4.407C5.57295 4.3599 5.20912 4.38379 4.8603 4.4773C4.51148 4.57081 4.18449 4.73212 3.898 4.952C3.6554 5.14648 3.44688 5.38001 3.281 5.643C3.111 5.897 2.925 6.218 2.703 6.603L2.678 6.647C2.455 7.032 2.27 7.353 2.136 7.627C1.996 7.913 1.886 8.195 1.846 8.507C1.7506 9.22999 1.94628 9.96127 2.39 10.54C2.621 10.841 2.922 11.06 3.262 11.274C3.38864 11.3491 3.49415 11.4551 3.56865 11.582C3.64316 11.709 3.68422 11.8528 3.688 12C3.68422 12.1472 3.64316 12.291 3.56865 12.418C3.49415 12.5449 3.38864 12.6509 3.262 12.726C2.922 12.94 2.622 13.159 2.39 13.46C2.17012 13.7465 2.00882 14.0735 1.91531 14.4223C1.8218 14.7711 1.79791 15.1349 1.845 15.493C1.886 15.805 1.995 16.087 2.135 16.373C2.27 16.647 2.455 16.968 2.678 17.353L2.703 17.397C2.925 17.782 3.111 18.103 3.281 18.357C3.458 18.62 3.648 18.857 3.898 19.047C4.18441 19.2671 4.51137 19.4285 4.86019 19.5222C5.20902 19.6159 5.57288 19.64 5.931 19.593C6.307 19.543 6.647 19.393 7.003 19.204C7.13121 19.1323 7.27548 19.0943 7.42236 19.0934C7.56924 19.0925 7.71395 19.1289 7.843 19.199C7.96932 19.2749 8.07401 19.382 8.14703 19.51C8.22005 19.638 8.25895 19.7826 8.26 19.93C8.275 20.332 8.314 20.702 8.46 21.052C8.59809 21.3857 8.80058 21.689 9.05589 21.9445C9.3112 22.2 9.61435 22.4027 9.948 22.541C10.238 22.661 10.538 22.708 10.855 22.729C11.159 22.75 11.53 22.75 11.975 22.75H12.025C12.47 22.75 12.841 22.75 13.145 22.73C13.463 22.708 13.762 22.661 14.052 22.54C14.3858 22.4019 14.689 22.1994 14.9445 21.9441C15.2 21.6888 15.4027 21.3857 15.541 21.052C15.686 20.702 15.725 20.332 15.741 19.93C15.7426 19.7828 15.7815 19.6385 15.8541 19.5105C15.9267 19.3825 16.0306 19.275 16.156 19.198C16.2853 19.1278 16.4302 19.0916 16.5773 19.0926C16.7243 19.0937 16.8688 19.132 16.997 19.204C17.353 19.392 17.693 19.543 18.069 19.592C18.792 19.6874 19.5233 19.4917 20.102 19.048C20.352 18.856 20.542 18.62 20.719 18.357C20.889 18.103 21.075 17.782 21.297 17.397L21.322 17.353C21.545 16.968 21.73 16.647 21.864 16.373C22.004 16.087 22.114 15.804 22.154 15.493C22.2494 14.77 22.0537 14.0387 21.61 13.46C21.379 13.159 21.078 12.94 20.738 12.726C20.6114 12.6509 20.5059 12.5449 20.4314 12.418C20.3569 12.291 20.3158 12.1472 20.312 12C20.312 11.722 20.464 11.446 20.738 11.274C21.078 11.06 21.378 10.841 21.61 10.54C21.8299 10.2535 21.9912 9.92653 22.0847 9.5777C22.1782 9.22888 22.2021 8.86506 22.155 8.507C22.1079 8.1996 22.0099 7.90219 21.865 7.627C21.6942 7.29478 21.5131 6.96795 21.322 6.647L21.297 6.603C21.1143 6.27708 20.9216 5.95692 20.719 5.643C20.553 5.38036 20.3445 5.14718 20.102 4.953C19.8156 4.73294 19.4886 4.57146 19.1398 4.47778C18.791 4.38409 18.4271 4.36004 18.069 4.407C17.693 4.457 17.353 4.607 16.997 4.796C16.8688 4.86767 16.7245 4.90572 16.5776 4.9066C16.4308 4.90747 16.2861 4.87114 16.157 4.801C16.0313 4.72438 15.9272 4.61712 15.8542 4.48928C15.7813 4.36143 15.742 4.21717 15.74 4.07C15.725 3.668 15.686 3.298 15.54 2.948C15.4019 2.61425 15.1994 2.31097 14.9441 2.05549C14.6888 1.8 14.3857 1.59731 14.052 1.459C13.762 1.339 13.462 1.292 13.145 1.271C12.841 1.25 12.47 1.25 12.025 1.25H11.975ZM10.522 2.845C10.599 2.813 10.716 2.784 10.957 2.767C11.204 2.75 11.524 2.75 12 2.75C12.476 2.75 12.796 2.75 13.043 2.767C13.284 2.784 13.401 2.813 13.478 2.845C13.785 2.972 14.028 3.215 14.155 3.522C14.195 3.618 14.228 3.769 14.241 4.126C14.271 4.918 14.68 5.681 15.406 6.1C16.132 6.519 16.997 6.492 17.698 6.122C18.014 5.955 18.161 5.908 18.265 5.895C18.5936 5.85158 18.9259 5.94043 19.189 6.142C19.255 6.193 19.339 6.28 19.474 6.48C19.613 6.686 19.773 6.963 20.011 7.375C20.249 7.787 20.408 8.065 20.517 8.287C20.624 8.504 20.657 8.62 20.667 8.703C20.7104 9.03157 20.6216 9.36392 20.42 9.627C20.356 9.71 20.242 9.814 19.94 10.004C19.268 10.426 18.812 11.162 18.812 12C18.812 12.838 19.268 13.574 19.94 13.996C20.242 14.186 20.356 14.29 20.42 14.373C20.622 14.636 20.71 14.968 20.667 15.297C20.657 15.38 20.623 15.497 20.517 15.713C20.408 15.936 20.249 16.213 20.011 16.625C19.773 17.037 19.612 17.314 19.474 17.52C19.339 17.72 19.255 17.807 19.189 17.858C18.9259 18.0596 18.5936 18.1484 18.265 18.105C18.161 18.092 18.015 18.045 17.698 17.878C16.998 17.508 16.132 17.48 15.406 17.899C14.68 18.318 14.271 19.082 14.241 19.874C14.228 20.231 14.195 20.382 14.155 20.478C14.0922 20.6298 14.0001 20.7677 13.8839 20.8839C13.7677 21.0001 13.6298 21.0922 13.478 21.155C13.401 21.187 13.284 21.216 13.043 21.233C12.796 21.25 12.476 21.25 12 21.25C11.524 21.25 11.204 21.25 10.957 21.233C10.716 21.216 10.599 21.187 10.522 21.155C10.3702 21.0922 10.2323 21.0001 10.1161 20.8839C9.99995 20.7677 9.90783 20.6298 9.845 20.478C9.805 20.382 9.772 20.231 9.759 19.874C9.729 19.082 9.32 18.319 8.594 17.9C7.868 17.481 7.003 17.508 6.302 17.878C5.986 18.045 5.839 18.092 5.735 18.105C5.40644 18.1484 5.07408 18.0596 4.811 17.858C4.745 17.807 4.661 17.72 4.526 17.52C4.33789 17.2272 4.1588 16.9288 3.989 16.625C3.751 16.213 3.592 15.935 3.483 15.713C3.376 15.496 3.343 15.38 3.333 15.297C3.28959 14.9684 3.37843 14.6361 3.58 14.373C3.644 14.29 3.758 14.186 4.06 13.996C4.732 13.574 5.188 12.838 5.188 12C5.188 11.162 4.732 10.426 4.06 10.004C3.758 9.814 3.644 9.71 3.58 9.627C3.37843 9.36392 3.28959 9.03157 3.333 8.703C3.343 8.62 3.377 8.503 3.483 8.287C3.592 8.064 3.751 7.787 3.989 7.375C4.227 6.963 4.388 6.686 4.526 6.48C4.661 6.28 4.745 6.193 4.811 6.142C5.07408 5.94043 5.40644 5.85158 5.735 5.895C5.839 5.908 5.985 5.955 6.302 6.122C7.002 6.492 7.868 6.52 8.594 6.1C9.32 5.681 9.729 4.918 9.759 4.126C9.772 3.769 9.805 3.618 9.845 3.522C9.972 3.215 10.215 2.972 10.522 2.845Z"
                            fill="#8E8E93" />
                    </svg></button>
                <button id="popout" class="btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                        viewBox="0 0 24 24" fill="none">
                        <path
                            d="M19.5 12.75C19.5 12.5511 19.579 12.3603 19.7197 12.2197C19.8603 12.079 20.0511 12 20.25 12C20.4489 12 20.6397 12.079 20.7803 12.2197C20.921 12.3603 21 12.5511 21 12.75V18C21 18.7956 20.6839 19.5587 20.1213 20.1213C19.5587 20.6839 18.7956 21 18 21H6C5.20435 21 4.44129 20.6839 3.87868 20.1213C3.31607 19.5587 3 18.7956 3 18V6C3 5.20435 3.31607 4.44129 3.87868 3.87868C4.44129 3.31607 5.20435 3 6 3H11.25C11.4489 3 11.6397 3.07902 11.7803 3.21967C11.921 3.36032 12 3.55109 12 3.75C12 3.94891 11.921 4.13968 11.7803 4.28033C11.6397 4.42098 11.4489 4.5 11.25 4.5H6C5.60218 4.5 5.22064 4.65804 4.93934 4.93934C4.65804 5.22064 4.5 5.60218 4.5 6V18C4.5 18.3978 4.65804 18.7794 4.93934 19.0607C5.22064 19.342 5.60218 19.5 6 19.5H18C18.3978 19.5 18.7794 19.342 19.0607 19.0607C19.342 18.7794 19.5 18.3978 19.5 18V12.75ZM11.82 13.2585C11.7515 13.3328 11.6686 13.3926 11.5764 13.4341C11.4842 13.4756 11.3846 13.498 11.2835 13.5C11.1824 13.5021 11.082 13.4836 10.9882 13.4458C10.8944 13.4081 10.8093 13.3517 10.7378 13.2802C10.6664 13.2086 10.6101 13.1234 10.5725 13.0295C10.5348 12.9357 10.5165 12.8352 10.5187 12.7341C10.5209 12.633 10.5434 12.5334 10.5851 12.4413C10.6267 12.3492 10.6866 12.2664 10.761 12.198L19.9575 3H15.75C15.5511 3 15.3603 2.92098 15.2197 2.78033C15.079 2.63968 15 2.44891 15 2.25C15 2.05109 15.079 1.86032 15.2197 1.71967C15.3603 1.57902 15.5511 1.5 15.75 1.5H21C21.3978 1.5 21.7794 1.65804 22.0607 1.93934C22.342 2.22064 22.5 2.60218 22.5 3V8.25C22.5 8.44891 22.421 8.63968 22.2803 8.78033C22.1397 8.92098 21.9489 9 21.75 9C21.5511 9 21.3603 8.92098 21.2197 8.78033C21.079 8.63968 21 8.44891 21 8.25V4.08L11.82 13.2585Z"
                            fill="#8E8E93" />
                    </svg></button>

            </div>
        </div>
        <div id="context">
        </div>

    </div>
    <div class="wrapper settings">
        <div class="actions">
            <p>Settings</p>
            <button id="closeSettings" class="btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path
                        d="M6.00001 3.60001C5.36349 3.60001 4.75304 3.85286 4.30295 4.30295C3.85286 4.75304 3.60001 5.36349 3.60001 6.00001V18C3.60001 18.6365 3.85286 19.247 4.30295 19.6971C4.75304 20.1472 5.36349 20.4 6.00001 20.4H9.60481C9.61281 20.2632 9.63441 20.1244 9.66961 19.9836L9.86521 19.2H7.20001V13.8C7.20001 13.6409 7.26322 13.4883 7.37574 13.3757C7.48826 13.2632 7.64088 13.2 7.80001 13.2H14.3328L15.5328 12H7.80001C7.32262 12 6.86478 12.1896 6.52721 12.5272C6.18965 12.8648 6.00001 13.3226 6.00001 13.8V19.2C5.68175 19.2 5.37652 19.0736 5.15148 18.8485C4.92643 18.6235 4.80001 18.3183 4.80001 18V6.00001C4.80001 5.68175 4.92643 5.37652 5.15148 5.15148C5.37652 4.92643 5.68175 4.80001 6.00001 4.80001H7.20001V7.80001C7.20001 8.2774 7.38965 8.73523 7.72721 9.0728C8.06478 9.41036 8.52262 9.60001 9.00001 9.60001H13.8C14.2774 9.60001 14.7352 9.41036 15.0728 9.0728C15.4104 8.73523 15.6 8.2774 15.6 7.80001V4.80001H16.0548C16.373 4.80007 16.6782 4.92655 16.9032 5.15161L18.8484 7.09681C19.0735 7.3218 19.1999 7.62697 19.2 7.94521V9.60361C19.606 9.58513 20.0122 9.63793 20.4 9.75961V7.94641C20.3999 7.30994 20.1469 6.69959 19.6968 6.24961L17.7516 4.30441C17.5289 4.08131 17.2644 3.90428 16.9733 3.78342C16.6821 3.66255 16.37 3.60023 16.0548 3.60001H6.00001ZM8.40001 7.80001V4.80001H14.4V7.80001C14.4 7.95914 14.3368 8.11175 14.2243 8.22427C14.1117 8.33679 13.9591 8.40001 13.8 8.40001H9.00001C8.84088 8.40001 8.68826 8.33679 8.57574 8.22427C8.46322 8.11175 8.40001 7.95914 8.40001 7.80001ZM17.772 11.4576L11.976 17.2536C11.6383 17.5914 11.3986 18.0144 11.2824 18.4776L10.8324 20.2752C10.788 20.454 10.7906 20.6412 10.84 20.8187C10.8894 20.9962 10.9838 21.1578 11.1141 21.288C11.2444 21.4182 11.4062 21.5125 11.5837 21.5617C11.7612 21.6109 11.9485 21.6134 12.1272 21.5688L13.9248 21.12C14.388 21.0038 14.8111 20.7641 15.1488 20.4264L20.9448 14.6304C21.3602 14.2084 21.5919 13.6393 21.5895 13.0472C21.5871 12.4551 21.3507 11.8879 20.932 11.4693C20.5132 11.0506 19.9459 10.8145 19.3538 10.8123C18.7617 10.8101 18.1927 11.0421 17.7708 11.4576"
                        fill="black" />
                </svg></button>
        </div>
        <div class="settings-container">
            <div class="setting-item">
                <div id="apiKeyText"></div>
                <input type="text" class="settings-text" id="apiKey">
                <a href="https://github.com/wwardaww/gnome-gemini-ai?tab=readme-ov-file#using-gemini-api-key"
                    target="_blank" id="howTo"></a>
            </div>
            <div class="setting-item">
                <div id="selectThemeText" class="settings-label"></div>
                <select class="settings-text" id="theme">
                    <option value="dark">Dark</option>
                    <option value="light">Light</option>
                </select>
                <div style="display: block;"></div>
            </div>
            <div class="setting-item">
                <div id="selectModelText" class="settings-label"></div>
                <select class="settings-text" id="aiModel">
                    <option value="gemini-1.0-pro">Gemini 1.0 Pro</option>
                    <option value="gemini-1.5-flash">Gemini 1.5 Flash</option>
                    <option value="gemini-1.5-flash-002">Gemini 1.5 Flash 002</option>
                    <option value="gemini-1.5-8b">Gemini 1.5 Flash 8B</option>
                    <option value="gemini-1.5-pro">Gemini 1.5 Pro</option>
                    <option value="gemini-1.5-pro-002">Gemini 1.5 Pro 002</option>
                </select>
                <div style="display: block;"></div>
            </div>
        </div>
    </div>
    </div>
    <!-- MARK: Comm with Engine-->
    <script>
        window.resizeTo = (w, h) => window.ipc?.postMessage(`resize=${w},${h}`);
        window.engineStorage = (data) => window.ipc?.postMessage(`store=${data}`);
        window.popout = () => window.ipc?.postMessage(`popout=`);
    </script>

    <!-- MARK: System Variables -->
    <script>
        var sysVars;
        var storage;
    </script>
    <script>
        if (!storage) {
            storage = {
                chatHistory: [],
                settings: {
                    model: "gemini-1.0-pro"
                }
            }
        }
        //MARK: Variables
        const chatField = document.getElementById("chat");
        const deleteBtn = document.getElementById("delete");
        const settingsBtn = document.getElementById("settings");
        const popoutBtn = document.getElementById("popout");
        const closeSettings = document.getElementById("closeSettings");
        const container = document.getElementById("context");
        const md = markdownit({
            html: true,
            typographer: true,
            linkify: false,
            highlight: function (str, lang) {
                if (lang && hljs.getLanguage(lang)) {
                    try {
                        return hljs.highlight(str, { language: lang }).value;
                    } catch (__) { }
                }

                return '';
            }
        })
        // MARK: Init
        getHistory();
        getSettings();
        chatField.focus();
        //MARK: Translations
        chatField.setAttribute("placeholder", translate("What's on your mind?"));
        document.getElementById("apiKeyText").innerText = translate("Geminiai API Key");
        document.getElementById("howTo").innerText = translate("How to get API key?");
        document.getElementById("selectModelText").innerText = translate("Select Gemini Model");
        document.getElementById("selectThemeText").innerText = translate("Select Theme");
        //MARK: Events
        chatField.addEventListener("keypress", function (event) {
            if (event.key === "Enter") {
                event.preventDefault();
                let uuID = createChatbox(chatField.value);
                generateGeminiResponse(uuID, chatField.value);
                chatField.value = "";
            }
        });
        deleteBtn.addEventListener("click", function () {
            container.innerHTML = "";
            chatField.value = "";
            deleteHistory();
        });
        settingsBtn.addEventListener("click", function () {
            document.querySelector(".wrapper.settings").style.display = "block";
            document.querySelector(".wrapper.home").style.display = "none";
        })
        popoutBtn.addEventListener("click", function () {
            window.popout();
            document.body.classList.add("popout");
        })
        closeSettings.addEventListener("click", function () {
            document.querySelector(".wrapper.settings").style.display = "none";
            document.querySelector(".wrapper.home").style.display = "block";
            saveSettings();
        })
        //MARK: Functions
        function createChatbox(question, answer = undefined) {
            const chatBox = document.createElement("div");
            const uuID = `ar_${Date.now()}`;
            let canResize = false;
            if (container.childNodes.length > 1) {
                canResize = true;
            }
            chatBox.classList.add("chatBox");
            chatBox.setAttribute("ai-id", uuID);
            let aiRes = translate("<b>Gemini: </b> Thinking...")
            if (answer) {
                aiRes = md.render(answer);
            }
            chatBox.innerHTML = `
             <div class="userStory"><b>${sysVars?.userName}:</b> ${question}
                <div class="invDel"><button class="btn miniBtn"
                            onclick="deleteChatbox('ar_1728999483260')"><svg xmlns="http://www.w3.org/2000/svg"
                                width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <path
                                    d="M20.25 4.49998H16.5V3.74998C16.5 3.15325 16.2629 2.58095 15.841 2.15899C15.419 1.73704 14.8467 1.49998 14.25 1.49998H9.75C9.15326 1.49998 8.58097 1.73704 8.15901 2.15899C7.73705 2.58095 7.5 3.15325 7.5 3.74998V4.49998H3.75C3.55109 4.49998 3.36032 4.579 3.21967 4.71965C3.07902 4.86031 3 5.05107 3 5.24998C3 5.4489 3.07902 5.63966 3.21967 5.78031C3.36032 5.92097 3.55109 5.99998 3.75 5.99998H4.5V19.5C4.5 19.8978 4.65804 20.2793 4.93934 20.5606C5.22064 20.8419 5.60218 21 6 21H18C18.3978 21 18.7794 20.8419 19.0607 20.5606C19.342 20.2793 19.5 19.8978 19.5 19.5V5.99998H20.25C20.4489 5.99998 20.6397 5.92097 20.7803 5.78031C20.921 5.63966 21 5.4489 21 5.24998C21 5.05107 20.921 4.86031 20.7803 4.71965C20.6397 4.579 20.4489 4.49998 20.25 4.49998ZM9 3.74998C9 3.55107 9.07902 3.36031 9.21967 3.21965C9.36032 3.079 9.55109 2.99998 9.75 2.99998H14.25C14.4489 2.99998 14.6397 3.079 14.7803 3.21965C14.921 3.36031 15 3.55107 15 3.74998V4.49998H9V3.74998ZM18 19.5H6V5.99998H18V19.5ZM10.5 9.74998V15.75C10.5 15.9489 10.421 16.1397 10.2803 16.2803C10.1397 16.421 9.94891 16.5 9.75 16.5C9.55109 16.5 9.36032 16.421 9.21967 16.2803C9.07902 16.1397 9 15.9489 9 15.75V9.74998C9 9.55107 9.07902 9.36031 9.21967 9.21966C9.36032 9.079 9.55109 8.99998 9.75 8.99998C9.94891 8.99998 10.1397 9.079 10.2803 9.21966C10.421 9.36031 10.5 9.55107 10.5 9.74998ZM15 9.74998V15.75C15 15.9489 14.921 16.1397 14.7803 16.2803C14.6397 16.421 14.4489 16.5 14.25 16.5C14.0511 16.5 13.8603 16.421 13.7197 16.2803C13.579 16.1397 13.5 15.9489 13.5 15.75V9.74998C13.5 9.55107 13.579 9.36031 13.7197 9.21966C13.8603 9.079 14.0511 8.99998 14.25 8.99998C14.4489 8.99998 14.6397 9.079 14.7803 9.21966C14.921 9.36031 15 9.55107 15 9.74998Z"
                                    fill="#8E8E93" />
                            </svg>
                        </button></div>
                </div>
             <div class="aiStory" id="${uuID}">${aiRes}</div>
             `;
            container.appendChild(chatBox);
            if (canResize) {
                updateSize();
            }
            return uuID;
        }
        function deleteChatbox(uuID) {
            let c = document.querySelector(`.chatBox[ai-id="${uuID}"]`);
            let aiC = document.getElementById(uuID);
            const qID = aiC.getAttribute("q-id");
            const aID = aiC.getAttribute("answ-id");
            storage.chatHistory.splice(qID, 1);
            storage.chatHistory.splice(aID, 1);
            saveStorage();
            c.parentNode.removeChild(c);
        }
        function updateSize(width = false, height = false) {
            let maxHeight = (height ? height * 1.7 : container.offsetHeight + 100);
            if (maxHeight > 800) {
                maxHeight = 800;
            }
            window.resizeTo(((width * 1.7) ? container.offsetWidth : 0), maxHeight);
        }

        //MARK: Generate Ai responses
        async function generateGeminiResponse(uuID, input) {
            const body = JSON.stringify([
                ...storage.chatHistory,
                {
                    role: "user",
                    parts: [{ text: input }]
                }
            ])
            const resPromise = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${storage.settings.model}:generateContent?key=${storage.settings.apiKey}`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: `{"contents":${body}}`
            });
            let res = await resPromise.text();
            res = JSON.parse(res);
            const aiResponse = res.candidates[0]?.content?.parts[0]?.text || "";
            const resContainer = document.getElementById(uuID);
            resContainer.innerHTML = md.render(aiResponse);
            updateSize();
            storage.chatHistory.push({
                role: "user",
                parts: [{ text: input }],
            });
            resContainer.setAttribute("q-id", (storage.chatHistory.length - 1));
            storage.chatHistory.push({
                role: "model",
                parts: [{ text: aiResponse }],
            });
            resContainer.setAttribute("answ-id", (storage.chatHistory.length - 1));
            saveStorage();
        }
        function saveStorage() {
            const sString = JSON.stringify(storage);
            let encoder = new TextEncoder();
            window.engineStorage(encoder.encode(sString));
        }
        function getHistory() {
            if (storage.chatHistory.length > 0) {
                for (let i = 0; i < storage.chatHistory.length; i = i + 2) {
                    if (storage.chatHistory[i].role == "user") {
                        createChatbox(storage.chatHistory[i].parts[0].text, storage.chatHistory[i + 1]?.parts[0].text);
                    }
                }
                updateSize();
            }
        }
        function deleteHistory() {
            storage.chatHistory = [];
            saveStorage();
        }

        function saveSettings() {
            const apiKey = document.getElementById("apiKey").value;
            const model = document.getElementById("aiModel").value;
            const theme = document.getElementById("theme").value;
            storage.settings = {
                apiKey,
                model,
                theme,
            }
            saveStorage();
        }
        function getSettings() {
            document.getElementById("apiKey").value = storage.settings?.apiKey || "";
            document.getElementById("aiModel").value = storage.settings?.model;
            document.getElementById("theme").value = storage.settings?.theme;


            if (storage.settings?.theme) {
                document.body.classList.remove("default");
                document.body.classList.remove("dark");
                document.body.classList.remove("light");
                document.body.classList.add(storage.settings?.theme);
            }
        }

    </script>
    <style>
        * {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: rgba(0, 0, 0, 0);
            overflow: hidden;
        }

        .popout {
            .wrapper {
                border-bottom-left-radius: 0px !important;
                border-bottom-right-radius: 0px !important;
                max-height: 100% !important;
                height: 100% !important;
            }
        }

        .wrapper {
            padding: 25px;
            border-bottom-left-radius: 25px;
            border-bottom-right-radius: 25px;
            min-height: 180px;
            max-height: 80%;
            overflow: scroll;
        }

        #chat {
            width: 75%;
            border-radius: 50px;
            background-color: #F2F2F7;
            padding: 10px 15px;
            border: 0;

            ::placeholder {
                color: #8E8E93;
            }
        }

        #context {
            margin-top: 20px;
        }

        .chatBox {
            display: flex;
            flex-direction: column;
            align-items: start;
            gap: 20px;
            justify-content: flex-start;
            padding: 20px 0;
            border-top: 1px solid #E5E5EA;

            .userStory {
                color: #8E8E93;
                position: relative;
                width: 100%;

                .invDel {
                    position: absolute;
                    right: 0;
                    top: 0;
                }
            }

            .aiStory {
                color: #1C1C1E;
            }
        }

        .light,
        .default {
            .wrapper {
                background-color: white;
                color: black;
            }

        }

        .dark {
            .wrapper {
                background-color: #1C1C1E;
                color: #F2F2F7;

                #chat {
                    background-color: #2C2C2E;
                    color: #F2F2F7;
                }

                .chatBox {
                    .aiStory {
                        color: #F2F2F7;
                    }
                }

                svg {
                    path {
                        fill: #8E8E93;
                    }
                }

                .btn:hover {
                    svg {
                        path {
                            fill: #F2F2F7;
                        }
                    }
                }
            }

        }

        .actions {
            display: flex;
            justify-content: space-between;
        }

        .btn {
            width: 30px;
            height: 30px;
            background-repeat: no-repeat;
            background-position: center;
            border: 0;
            background-color: transparent;
        }

        .btn:hover {
            cursor: pointer;

            svg {
                path {
                    fill: #1C1C1E;
                }
            }
        }

        .miniBtn{
            width: 20px;
            height: 20px;
        }

        pre {
            color: #c9d1d9;
            background: #0d1117;
            padding: 20px;
        }
    </style>
    <!--MARK: Settings Style -->
    <style>
        .settings {
            display: none;
        }

        .setting-item {
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            align-items: center;
            gap: 20px;
            margin-top: 20px;

            * {
                width: 33%;
            }
        }
    </style>

</body>

</html>